<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Mappa Cantine e Distillerie ‚Äì Valle di Cembra</title>
  <meta name="description" content="Mappa interattiva delle cantine e distillerie della Valle di Cembra (Trentino). Progetto a cura di Cantina Barone a Prato (dal 1539).">
  <link rel="icon" href="https://www.baroneaprato.com/wp-content/uploads/2025/09/logo-cantine-val-di-cembra.png">
  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin=""/>
  <!-- MarkerCluster -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" crossorigin=""/>
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" crossorigin=""/>
  <style>
    :root { --line:#eee; --text:#111; --muted:#666; }
    html, body { height:100%; }
    body{
      margin:0; background:#fafafa; color:var(--text);
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
      display:flex; flex-direction:column; min-height:100%;
    }
    .wrap{ max-width:1100px; width:100%; margin:0 auto; padding:16px; flex:1 0 auto; }
    #map{ height:70vh; border:1px solid var(--line); border-radius:12px; }
    .intro{color:#666;font-size:15px;margin:0 0 10px;text-align:center;line-height:1.45}
    .credit{text-align:center;font-size:14px;color:#666;margin-top:10px}
    @media (max-width:600px){ #map{height:65vh} }
  </style>
  <!-- Analytics (facoltativo)
  <script defer data-domain="baroneaprato.github.io,mappe.baroneaprato.com" src="https://plausible.io/js/script.js"></script>
  -->
</head>
<body>
  <div class="wrap">
    <!-- Intro sopra la mappa -->
    <p class="intro">üìç Clicca sui segnaposto con il bicchiere per aprire il sito, avviare le indicazioni o contattare ogni cantina e distilleria.</p>

    <!-- MAPPA -->
    <div id="map"></div>

    <!-- Unico credit -->
    <div class="credit">Mappa realizzata con ‚ù§Ô∏è da Cantina Barone a Prato (dal 1539)</div>
  </div>

  <!-- Script Leaflet & Cluster -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js" crossorigin=""></script>

  <script>
    /* MAPPA BASE */
    const map = L.map('map', { zoomSnap: 0.25 }).setView([46.175, 11.22], 12);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19, attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    /* ICONA (logo bicchiere) */
    const iconUrl = "https://www.baroneaprato.com/wp-content/uploads/2025/09/logo-cantine-val-di-cembra.png";
    const wineIcon = L.icon({ iconUrl, iconSize:[40,40], iconAnchor:[20,40], popupAnchor:[0,-35],
      shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png' });
    const baroneIcon = L.icon({ iconUrl, iconSize:[48,48], iconAnchor:[24,48], popupAnchor:[0,-40],
      shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png' });

    /* Utility */
    const prettyTel = t => (t||'').replace(/^\+39/, '+39 ').replace(/(\d{3})(\d{3})(\d{3,})$/, '$1 $2 $3');
    const btn = (label, href, primary=false, show=null) =>
      `<a href="${href}" target="_blank" rel="noopener"
         style="display:inline-block;margin:6px 6px 0 0;padding:8px 12px;border-radius:8px;
         border:1px solid ${primary?'#111':'#ddd'};background:${primary?'#111':'#fff'};
         color:${primary?'#fff':'#111'};text-decoration:none;font-weight:600;font-size:13px">
         ${show||label}</a>`;

    const popupHtml = (w) => {
      const links = [];
      if (w.url)   links.push(btn('Apri sito', w.url));
      if (w.maps)  links.push(btn('Apri indicazioni', w.maps, true));
      if (w.tel)   links.push(btn('Chiama', 'tel:'+w.tel, false, 'Chiama ' + prettyTel(w.tel)));
      if (w.email) links.push(btn('Email', 'mailto:'+w.email));
      return `${w.name}<br/><small>${w.town}</small><div style="margin-top:6px">${links.join('')}</div>`;
    };

    /* DATI ‚Äì 22 realt√† (type: 'cantina' | 'distilleria') */
    const WINERIES = [
      { type:'cantina', name:'Cantina Barone a Prato dal 1539', town:'Segonzano (Piazzo)', url:'https://www.baroneaprato.com/', email:'paolo@baroneaprato.com', tel:'+393477593662', lat:46.182920265226, lng:11.251048352853, maps:'https://www.google.com/maps/dir/?api=1&destination=46.182920265226,11.251048352853&travelmode=driving' },
      { type:'cantina', name:'Cantina B√©ghel', town:'Segonzano (Sevignano)', url:'https://www.cantinabeghel.it/', tel:'+393450695084', lat:46.172796, lng:11.251493, maps:'https://www.google.com/maps/dir/?api=1&destination=46.172796,11.251493&travelmode=driving' },
      { type:'distilleria', name:'Distilleria Giacomozzi Renzo', town:'Segonzano', tel:'+393486686100', lat:46.186773100444, lng:11.260688466145, maps:'https://www.google.com/maps/dir/?api=1&destination=46.186773100444,11.260688466145&travelmode=driving' },
      { type:'distilleria', name:'Distilleria Pilzer', town:'Faver (Altavalle)', url:'http://www.pilzer.it/', tel:'+390461683326', lat:46.197641952539, lng:11.246419787697, maps:'https://www.google.com/maps/dir/?api=1&destination=46.197641952539,11.246419787697&travelmode=driving' },
      { type:'cantina', name:'Pietra di Confine (Fratelli Giorgio e Federico Paolazzi)', town:'Faver (Altavalle)', email:'federicopaolazzi80@gmail.com', tel:'+393402473228', lat:46.1835637, lng:11.2405526, maps:'https://www.google.com/maps/dir/?api=1&destination=46.1835637,11.2405526&travelmode=driving' },
      { type:'distilleria', name:'Paolazzi Vittorio ‚Äì Distilleria', town:'Faver (Altavalle)', url:'https://www.grappapaolazzi.com/', tel:'+393476805616', lat:46.1844779, lng:11.2420793, maps:'https://www.google.com/maps/dir/?api=1&destination=46.1844779,11.2420793&travelmode=driving' },
      { type:'cantina', name:'Corv√©e', town:'Cembra Lisignago (Lisignago)', url:'https://www.corvee.wine/', tel:'+393499885827', lat:46.16892747275, lng:11.210182216302, maps:'https://www.google.com/maps/dir/?api=1&destination=46.16892747275,11.210182216302&travelmode=driving' },
      { type:'cantina', name:'Alfio Nicolodi', town:'Cembra Lisignago (Cembra)', tel:'+393484433199', lat:46.1771797, lng:11.2240382, maps:'https://www.google.com/maps/dir/?api=1&destination=46.1771797,11.2240382&travelmode=driving' },
      { type:'cantina', name:'Cantina Pelz', town:'Cembra Lisignago (Lisignago)', url:'https://www.instagram.com/cantina_pelz/', tel:'+393485900192', lat:46.169284115869, lng:11.217799689905, maps:'https://www.google.com/maps/dir/?api=1&destination=46.169284115869,11.217799689905&travelmode=driving' },
      { type:'cantina', name:'Cembra Cantina di Montagna', town:'Cembra Lisignago (Cembra)', url:'https://www.cembracantinadimontagna.it/', email:'info@cembracantinadimontagna.com', tel:'+390461680010', lat:46.1755432, lng:11.2233049, maps:'https://www.google.com/maps/dir/?api=1&destination=46.1755432,11.2233049&travelmode=driving' },
      { type:'cantina', name:'Tenuta Gottardi', town:'Cembra Lisignago (Cembra)', url:'http://www.tenutagottardi.it/', tel:'+393463285606', lat:46.176919685286, lng:11.223373012164, maps:'https://www.google.com/maps/dir/?api=1&destination=46.176919685286,11.223373012164&travelmode=driving' },
      { type:'cantina', name:'Cantina Toniolli', town:'Cembra Lisignago (Lisignago)', url:'http://www.cantinatoniolli.com/', email:'info@cantinatoniolli.com', tel:'+393486950258', lat:46.170340786963, lng:11.219238514542, maps:'https://www.google.com/maps/dir/?api=1&destination=46.170340786963,11.219238514542&travelmode=driving' },
      { type:'cantina', name:'Zanotelli', town:'Cembra Lisignago (Cembra)', url:'https://www.zanotelliwines.com/', tel:'+390461680362', lat:46.1747996, lng:11.2212154, maps:'https://www.google.com/maps/dir/?api=1&destination=46.1747996,11.2212154&travelmode=driving' },
      { type:'cantina', name:'Cantina Simoni', town:'Giovo (Pal√π)', url:'https://www.cantinasimoni.it/', email:'info@cantinasimoni.it', tel:'+393490504864', lat:46.1582951, lng:11.1405473, maps:'https://www.google.com/maps/dir/?api=1&destination=46.1582951,11.1405473&travelmode=driving' },
      { type:'cantina', name:'Maso Belvedere', town:'Giovo (Verla)', url:'https://masobelvedere.it/', email:'info@masobelvedere.it', tel:'+393392528710', lat:46.163235, lng:11.165742, maps:'https://www.google.com/maps/dir/?api=1&destination=46.163235,11.165742&travelmode=driving' },
      { type:'cantina', name:'Man Spumanti', town:'Giovo (Verla)', url:'https://www.manspumanti.it', email:'info@manspumanti.it', tel:'+393489238968', lat:46.1585379, lng:11.1537571, maps:'https://www.google.com/maps/dir/?api=1&destination=46.1585379,11.1537571&travelmode=driving' },
      { type:'cantina', name:'Villa Corniole', town:'Giovo (Verla)', url:'https://www.villacorniole.com/', email:'info@villacorniole.com', tel:'+390461695067', lat:46.158721833482, lng:11.155152557672, maps:'https://www.google.com/maps/dir/?api=1&destination=46.158721833482,11.155152557672&travelmode=driving' },
      { type:'cantina', name:'Cantina Micheli', town:'Lona-Lases (Lona)', url:'http://www.cantinamicheli.it/', tel:'+393484433199', lat:46.1583452, lng:11.2317809, maps:'https://www.google.com/maps/dir/?api=1&destination=46.1583452,11.2317809&travelmode=driving' },
      { type:'cantina', name:'Pojer e Sandri', town:"Faedo (San Michele all'Adige)", url:"https://www.pojeresandri.com/", tel:"+390461650342", lat:46.198661, lng:11.133553, maps:"https://www.google.com/maps/dir/?api=1&destination=46.198661,11.133553&travelmode=driving" },
      { type:'cantina', name:'Tenute Novei (Cantina Novel)', town:'Cembra Lisignago (Cembra)', url:'https://www.tenutenovei.it/', tel:'+393513157612', lat:46.176102, lng:11.220893, maps:'https://www.google.com/maps/dir/?api=1&destination=46.176102,11.220893&travelmode=driving' },
      { type:'cantina', name:'Cantina MoS', town:'Cembra Lisignago (Lisignago)', url:'https://www.agricola-mos.it/', email:'info@agricola-mos.it', tel:'+393208258736', lat:46.165374, lng:11.210597, maps:'https://www.google.com/maps/dir/?api=1&destination=46.165374,11.210597&travelmode=driving' },
      { type:'cantina', name:'La Campirl√≤ta', town:'Cembra Lisignago (Lisignago)', url:'https://www.lacampirlota.it/', email:'info@lacampirlota.it', tel:'+393495805345', lat:46.171973, lng:11.218412, maps:'https://www.google.com/maps/dir/?api=1&destination=46.171973,11.218412&travelmode=driving' }
    ];

    /* CLUSTER (evita sovrapposizioni) */
    const cluster = L.markerClusterGroup({
      spiderfyOnMaxZoom:true,
      showCoverageOnHover:false,
      disableClusteringAtZoom:16,
      maxClusterRadius:50
    });

    /* MARKER */
    const markers = [];
    WINERIES.forEach(w => {
      if (!w.lat || !w.lng) return;
      const iconChoice = (w.name === 'Cantina Barone a Prato dal 1539' ? baroneIcon : wineIcon);
      const m = L.marker([w.lat, w.lng], { icon: iconChoice }).bindPopup(popupHtml(w));
      cluster.addLayer(m);
      markers.push(m);
    });
    map.addLayer(cluster);

    /* Fit bounds iniziale */
    if (markers.length){
      const group = L.featureGroup(markers);
      map.fitBounds(group.getBounds().pad(0.2));
    }
  </script>
</body>
</html>

